--OLD QUERY:

-------------

SET SCHEMA data;

SELECT
    daily.datetime as datetime,
    daily.value as value,
    series.title
FROM
    series
LEFT JOIN
    daily
ON
    series.id = daily.series_id
WHERE 
    series.id = 2181 AND datetime between '1996-11-16 00:00:00' and '1996-12-16 00:00:00'
ORDER BY
   datetime;

-------------

/*

Arguments (parameters):
- series_id [e.g. 2181]
- start_date [e.g. 1996-11-16 00:00:00]
- end_date [e.g. 1996-12-16 00:00:00]

What it does:
- selects a time series with id series_id
- gets fields 1) timestamp for each value 2) value 3) title from a different table
- filters the time series by only getting the values between start_date and end_date
- orders by timestamps

Output:

+----------------------------+--------------------------+--------+
| datetime                   | value                    | title  |
+============================+==========================+========+
| 1996-11-16 00:00:00.000000 |               5.99681875 | Halden |
| 1996-11-17 00:00:00.000000 |              5.864708333 | Halden |
| 1996-11-18 00:00:00.000000 |              5.856014286 | Halden |
| 1996-11-19 00:00:00.000000 |                  5.81175 | Halden |
| 1996-11-20 00:00:00.000000 |               5.76165873 | Halden |
| 1996-11-21 00:00:00.000000 |              5.710753968 | Halden |
| 1996-11-22 00:00:00.000000 |              5.727409091 | Halden |
| 1996-11-23 00:00:00.000000 |              5.695077381 | Halden |
| 1996-11-24 00:00:00.000000 |                   5.6386 | Halden |
| 1996-11-25 00:00:00.000000 |              5.637758333 | Halden |
| 1996-11-26 00:00:00.000000 |               5.62397619 | Halden |
| 1996-11-27 00:00:00.000000 |              5.971857143 | Halden |
| 1996-11-28 00:00:00.000000 |              5.973841667 | Halden |
| 1996-11-29 00:00:00.000000 |               5.86130119 | Halden |
| 1996-11-30 00:00:00.000000 |              5.800471726 | Halden |
| 1996-12-01 00:00:00.000000 |              6.478918651 | Halden |
| 1996-12-02 00:00:00.000000 |              6.165869886 | Halden |
| 1996-12-03 00:00:00.000000 |              6.157533333 | Halden |
| 1996-12-04 00:00:00.000000 |              6.159861607 | Halden |
| 1996-12-05 00:00:00.000000 |              6.002095238 | Halden |
| 1996-12-06 00:00:00.000000 |                 5.920325 | Halden |
| 1996-12-07 00:00:00.000000 |              5.876191071 | Halden |
| 1996-12-08 00:00:00.000000 |              5.843911111 | Halden |
| 1996-12-09 00:00:00.000000 |                  5.80825 | Halden |
| 1996-12-10 00:00:00.000000 |              5.806858333 | Halden |
| 1996-12-11 00:00:00.000000 |              5.815658333 | Halden |
| 1996-12-12 00:00:00.000000 |              5.848830357 | Halden |
| 1996-12-13 00:00:00.000000 |              5.793089583 | Halden |
| 1996-12-14 00:00:00.000000 |                5.7861875 | Halden |
| 1996-12-15 00:00:00.000000 |                   6.2395 | Halden |
| 1996-12-16 00:00:00.000000 |              6.093289286 | Halden |
+----------------------------+--------------------------+--------+

*/

--NEW QUERY:

-------------

SET SCHEMA data;

SELECT
    daily.datetime as datetime,
	CASE
	WHEN daily.datetime BETWEEN '1996-11-25 00:00:00' AND '1996-12-05 00:00:00'
		THEN NULL 
	ELSE daily.value
	END AS value,
    series.title
FROM
    series
LEFT JOIN
    daily
ON
    series.id = daily.series_id
WHERE 
    series.id = 2181 AND datetime between '1996-11-16 00:00:00' and '1996-12-16 00:00:00'
ORDER BY
   datetime;

-------------

/*

Additional arguments:
- exclude_start [e.g. 1996-11-25 00:00:00]
- exclude_end [e.g. 1996-12-05 00:00:00]

What it does:
- same as before, except:
- values between exclude_start and exclude_end has to be set to NULL

Required output:

+----------------------------+--------------------------+--------+
| datetime                   | value                    | title  |
+============================+==========================+========+
| 1996-11-16 00:00:00.000000 |               5.99681875 | Halden |
| 1996-11-17 00:00:00.000000 |              5.864708333 | Halden |
| 1996-11-18 00:00:00.000000 |              5.856014286 | Halden |
| 1996-11-19 00:00:00.000000 |                  5.81175 | Halden |
| 1996-11-20 00:00:00.000000 |               5.76165873 | Halden |
| 1996-11-21 00:00:00.000000 |              5.710753968 | Halden |
| 1996-11-22 00:00:00.000000 |              5.727409091 | Halden |
| 1996-11-23 00:00:00.000000 |              5.695077381 | Halden |
| 1996-11-24 00:00:00.000000 |                   5.6386 | Halden |
| 1996-11-25 00:00:00.000000 |                     null | Halden |
| 1996-11-26 00:00:00.000000 |                     null | Halden |
| 1996-11-27 00:00:00.000000 |                     null | Halden |
| 1996-11-28 00:00:00.000000 |                     null | Halden |
| 1996-11-29 00:00:00.000000 |                     null | Halden |
| 1996-11-30 00:00:00.000000 |                     null | Halden |
| 1996-12-01 00:00:00.000000 |                     null | Halden |
| 1996-12-02 00:00:00.000000 |                     null | Halden |
| 1996-12-03 00:00:00.000000 |                     null | Halden |
| 1996-12-04 00:00:00.000000 |                     null | Halden |
| 1996-12-05 00:00:00.000000 |                     null | Halden |
| 1996-12-06 00:00:00.000000 |                 5.920325 | Halden |
| 1996-12-07 00:00:00.000000 |              5.876191071 | Halden |
| 1996-12-08 00:00:00.000000 |              5.843911111 | Halden |
| 1996-12-09 00:00:00.000000 |                  5.80825 | Halden |
| 1996-12-10 00:00:00.000000 |              5.806858333 | Halden |
| 1996-12-11 00:00:00.000000 |              5.815658333 | Halden |
| 1996-12-12 00:00:00.000000 |              5.848830357 | Halden |
| 1996-12-13 00:00:00.000000 |              5.793089583 | Halden |
| 1996-12-14 00:00:00.000000 |                5.7861875 | Halden |
| 1996-12-15 00:00:00.000000 |                   6.2395 | Halden |
| 1996-12-16 00:00:00.000000 |              6.093289286 | Halden |
+----------------------------+--------------------------+--------+

*/
